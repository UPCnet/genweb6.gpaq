$(function(){var r=$("#report-container").get(0);powerbi.bootstrap(r,{type:"report"});var t={type:"report",tokenType:window["powerbi-client"].models.TokenType.Embed,settings:{bars:{statusBar:{visible:!0}},filterPaneEnabled:!1}};$.ajax({type:"GET",url:$("body").attr("data-base-url")+"/getembedinfo",dataType:"json",success:function(e){result=$.parseJSON(JSON.stringify(e)),embedData=result.embed,filters=result.filters,t.accessToken=embedData.accessToken,t.embedUrl=embedData.reportConfig[0].embedUrl,tokenExpiry=embedData.tokenExpiry;var o=powerbi.embed(r,t);o.on("loaded",async function(){console.log("Report load successful");var e=await o.getPages();if(console.log(p),console.log(e),null!==filters.page&&""!==filters.page){const p=e.find(e=>e.displayName===filters.page);console.log(p),await o.setPage(p.name);const t=(await p.getVisuals()).filter(e=>"slicer"===e.type);console.log("Slicers"),console.log(t);var r,e=[];null!==filters.search_key_1&&""!==filters.search_key_1&&(r=await t.find(e=>e.title===filters.search_key_1).getFilters(),console.log("Visuals "+filters.search_key_1),console.log(r[0]),e.push({$schema:"http://powerbi.com/product/schema#basicFilter",target:{table:r[0].target.table,column:r[0].target.column},operator:"In",values:filters.search_value_1})),null!==filters.search_key_2&&""!==filters.search_key_2&&(r=await t.find(e=>e.title===filters.search_key_2).getFilters(),console.log("Visuals "+filters.search_key_2),console.log(r[0]),e.push({$schema:"http://powerbi.com/product/schema#basicFilter",target:{table:r[0].target.table,column:r[0].target.column},operator:"In",values:filters.search_value_2})),console.log("Filters"),console.log(e),o.setFilters(e).catch(e=>console.error("Error "+e))}}),o.on("rendered",function(){console.log("Report render successful")}),o.off("error"),o.on("error",function(e){e=e.detail;console.error(e)})},error:function(e){var r=$(".error-container");$(".embed-container").hide(),r.show();e=(e="<strong> Error Details: </strong> <br/>"+$.parseJSON(e.responseText).errorMsg).split("\n").join("<br/>");r.html(e)}})});